tinyMCE.PluginManager.add('FormatingToolbarButtons', function (editor, url) {
    ['pre', 'p', 'code', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'].forEach(function (name) {
        editor.ui.registry.addToggleButton("style-" + name, {
            tooltip: "Toggle " + name,
            text: name.toUpperCase(),
            onAction: function (button) {
                if (button.isActive()) {
                    editor.execCommand('mceToggleFormat', false, name);
                    button.setActive(false);
                }
                else {
                    editor.selection.setContent('<' + name + '>' + editor.selection.getContent() + '</' + name + '>');
                    button.setActive(true);
                }
            },
            onSetup: function (button) {
                editor.formatter.formatChanged(name, function (state) {
                    button.setActive(state);
                });
            }
        })
    });
});